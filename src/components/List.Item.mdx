import { Meta } from "@storybook/addon-docs/blocks";
import { Example } from "../../.storybook/blocks/Example";
import * as ItemStories from "./item.stories";

<hgroup>

<p className="category">Components</p>

# List.Item

The List.Item uses the `useList()` and helps you render the individual items of your `listAtom`.

</hgroup>

## Usage

```tsx
import { createList } from "@form-atoms/list-atom";

const { List } = createList(myAtom);

function Example() {
  <List.Item>
    {({fields, item, index, count, add, remove, moveUp, moveDown }) =>
      /* render item */
    }
  </List.Item>
}
```

## Children Props

| Name     | Type                                                                                        | Description                                                                                                |
| -------- | ------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------- |
| fields   | `Fields`                                                                                    | The fields of the current item, as created with the listAtom's `fields` config function.                   |
| item     | `SplitListItem<Fields>`                                                                     | The item from the internal splitList.                                                                      |
| index    | `number`                                                                                    | The index of the current item.                                                                             |
| count    | `number`                                                                                    | Total count of items in the list                                                                           |
| add      | `(before?: SplitListItem<Fields>, value?: FormFieldValues<Fields>) => ListItemForm<Fields>` | Append a new item to the list. When called with the current item, it will prepend it.                      |
| remove   | `() => void`                                                                                | Removes the current item from the list.                                                                    |
| moveUp   | `() => void`                                                                                | Moves the current item one slot up in the list. Supports carousel - the first item will become the last.   |
| moveDown | `() => void`                                                                                | Moves the current item one slot down in the list. Supports carousel - the last item will become the first. |

## Examples

<Example of={ItemStories.OrderingItems} >

```tsx
import { fieldAtom, InputField } from "form-atoms";
import { createList, listAtom } from "@form-atoms/list-atom";

const hobbies = listAtom({
  name: "hobbies",
  fields: () => ({ hobby: fieldAtom({ value: "" }) }),
});

const { List } = createList(hobbies);

const Example = () => (
  <List
    initialValue={[
      { hobby: "coding" },
      { hobby: "gardening" },
      { hobby: "mountain bike" },
    ]}
  >
    <List.Item>
      {({ fields, moveUp, moveDown, remove }) => (
        <fieldset role="group">
          <InputField atom={fields.hobby} component="input" />
          <button type="button" className="outline" onClick={moveUp}>
            Up
          </button>
          <button type="button" className="outline" onClick={moveDown}>
            Down
          </button>
          <button type="button" className="outline secondary" onClick={remove}>
            Remove
          </button>
        </fieldset>
      )}
    </List.Item>
  </List>
);
```

</Example>

<Example of={ItemStories.DisableCarouselOrdering} >

```tsx
import { fieldAtom, InputField } from "form-atoms";
import { createList, listAtom } from "@form-atoms/list-atom";

const hobbies = listAtom({
  name: "hobbies",
  fields: () => ({ hobby: fieldAtom({ value: "" }) }),
});

const { List } = createList(hobbies);

const Example = () => (
  <List
    initialValue={[
      { hobby: "coding" },
      { hobby: "gardening" },
      { hobby: "mountain bike" },
    ]}
  >
    <List.Item>
      {({ fields, index, count, moveUp, moveDown, remove }) => (
        <fieldset role="group">
          <InputField atom={fields.hobby} component="input" />
          <button
            type="button"
            className="outline"
            disabled={index === 0}
            onClick={moveUp}
          >
            Up
          </button>
          <button
            type="button"
            className="outline"
            disabled={index === count - 1}
            onClick={moveDown}
          >
            Down
          </button>
          <RemoveButton remove={remove} />
        </fieldset>
      )}
    </List.Item>
  </List>
);
```

</Example>

<Example of={ItemStories.Prepend} >

```tsx
import { fieldAtom, InputField } from "form-atoms";
import { createList, listAtom } from "@form-atoms/list-atom";

const hobbies = listAtom({
  name: "hobbies",
  fields: () => ({ hobby: fieldAtom({ value: "" }) }),
});

const { List } = createList(hobbies);

const Example = () => (
  <List
    initialValue={[
      { hobby: "swimming" },
      { hobby: "gardening" },
      { hobby: "coding" },
    ]}
  >
    <List.Item>
      {({ fields, item, add, remove }) => (
        <fieldset role="group">
          <InputField atom={fields.hobby} component="input" />
          <button type="button" className="outline" onClick={() => add(item)}>
            Prepend
          </button>
          <button type="button" className="outline secondary" onClick={remove}>
            Remove
          </button>
        </fieldset>
      )}
    </List.Item>
  </List>
);
```

</Example>
